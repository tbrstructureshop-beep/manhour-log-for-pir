<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Collaborative WO System</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- Global Loading Overlay -->
    <div id="global-loader" class="loader-overlay">
        <div class="spinner"></div>
        <p class="loader-text">Syncing Live Data...</p>
    </div>

    <!-- Header Section -->
    <header class="wo-header">
        <div class="header-grid">
            <div class="header-item">
                <label>Customer</label>
                <span id="info-customer">Loading...</span>
            </div>
            <div class="header-item">
                <label>A/C Reg</label>
                <span id="info-acreg">...</span>
            </div>
            <div class="header-item">
                <label>W/O No</label>
                <span id="info-wono">...</span>
            </div>
            <div class="header-item">
                <label>Part Desc</label>
                <span id="info-partdesc">...</span>
            </div>
            <div class="header-item">
                <label>Part No</label>
                <span id="info-partno">...</span>
            </div>
            <div class="header-item">
                <label>Serial No</label>
                <span id="info-serialno">...</span>
            </div>
        </div>
    </header>

    <!-- Findings Container -->
    <main id="findings-container">
        <!-- Injected via JS -->
    </main>

    <!-- MODALS -->
    
    <!-- Image Preview Modal -->
    <div id="modal-image" class="modal">
        <div class="modal-content image-modal-content">
            <span class="close-modal" onclick="UI.closeModal('modal-image')">&times;</span>
            <img id="modal-img-target" src="" alt="Full Preview">
        </div>
    </div>

    <!-- Conflict Modal (Parallel Work) -->
    <div id="modal-conflict" class="modal">
        <div class="modal-content">
            <h3>⚠️ Active Work Detected</h3>
            <p>The following mechanics are already working here:</p>
            <ul id="conflict-users-list"></ul>
            <p><strong>Do you want to join this job?</strong></p>
            <div class="modal-actions">
                <button class="btn-cancel" onclick="UI.closeModal('modal-conflict')">NO</button>
                <button class="btn-confirm" id="btn-conflict-confirm">YES, Start Parallel</button>
            </div>
        </div>
    </div>

    <!-- Stop Select User Modal -->
    <div id="modal-select-user" class="modal">
        <div class="modal-content">
            <h3>Identify Yourself</h3>
            <p>Select your session to stop:</p>
            <div id="stop-user-list" class="user-selection-grid"></div>
            <button class="btn-cancel full-width" onclick="UI.closeModal('modal-select-user')">Cancel</button>
        </div>
    </div>

    <!-- Final Status Modal -->
    <div id="modal-final-status" class="modal">
        <div class="modal-content">
            <h3>Job Finalization</h3>
            <p>You are the last active mechanic.</p>
            <p>Set final status:</p>
            <div class="modal-actions vertical">
                <button class="btn-hold" onclick="WorkFlow.finalize('ON_HOLD')">⏸ ON HOLD (Shift Change)</button>
                <button class="btn-close-job" onclick="WorkFlow.finalize('CLOSED')">✅ CLOSED (Job Done)</button>
            </div>
        </div>
    </div>

    <!-- Evidence Upload Modal -->
    <div id="modal-evidence" class="modal">
        <div class="modal-content">
            <h3>Upload Evidence</h3>
            <p>Upload a photo of the completed work.</p>
            <input type="file" id="evidence-file" accept="image/*">
            <div class="modal-actions">
                <button class="btn-confirm" onclick="WorkFlow.submitEvidence()">Submit & Close</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
